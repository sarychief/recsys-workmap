### VAE (Variational Autoencoder) для рекомендаций

**Основная идея, определение, назначение.**

- **Подаем на вход:**
    
    - Тот же вектор всех товаров (бинарный/счетный), отражающий взаимодействия пользователя.
        
- **Вероятностное кодирование:**
    
    - Вместо получения единственного _user vector_, энкодер вычисляет параметры распределения:
        
        - μ(x)\mu(x) – среднее,
            
        - σ(x)\sigma(x) – стандартное отклонение.
            
    - Используется _репараметризационный трюк_: z=μ(x)+σ(x)⋅ϵz = \mu(x) + \sigma(x) \cdot \epsilon с ϵ∼N(0,I)\epsilon \sim \mathcal{N}(0, I).
        
    - Таким образом, каждому пользователю сопоставляется распределение в латентном пространстве, а не фиксированное представление.
        
- **Декодирование:**
    
    - Декодер на основе сэмплированного zz пытается восстановить входной вектор.
        
    - Восстановленный вектор интерпретируется аналогично AE – вероятность релевантности товаров.
        
- **Целевая функция:**
    
    - Состоит из двух частей:
        
        - Реконструктивная потеря – измеряет, насколько точно декодер восстанавливает вход.
            
        - KL-дивергенция – регуляризует распределение q(z∣x)q(z|x), приводя его к стандартному нормальному p(z)p(z).
            
- **Инференс:**
    
    - Используем сэмплированный _user vector_ для скалярного умножения с векторами айтемов, получая выходные оценки.
        
