### Multi-VAE для рекомендательных систем

**Основная идея, определение, назначение.**

- **Подаем на вход:**
    
    - Вектор взаимодействий пользователя с товарами, представленный как bag-of-items (часто разреженный, бинарный или с количеством кликов/взаимодействий).
        
- **Вероятностное кодирование (как в VAE):**
    
    - Энкодер вычисляет параметры распределения (μ\mu и σ\sigma) для латентного представления.
        
    - Применяется репараметризационный трюк для получения латентного вектора zz.
        
- **Декодирование с мультиномиальным правдоподобием:**
    
    - В отличие от стандартного VAE, декодер Multi-VAE восстанавливает входной вектор, используя **мультиномиальное распределение**.
        
    - Это позволяет лучше моделировать дискретные и разреженные данные, характерные для взаимодействий в рекомендательных системах.
        
- **Целевая функция:**
    
    - Включает реконструктивную потерю, рассчитанную по логарифму правдоподобия мультиномиального распределения,
        
    - Плюс KL-дивергенцию, обеспечивающую регуляризацию латентного пространства.
        
- **Инференс:**
    
    - Латентное представление пользователя (user vector) используется для расчета релевантности каждого товара через скалярное произведение с предобученными эмбеддингами айтемов.
        
    - Выходной вектор дает вероятности рекомендаций для всех товаров.
        

---

### Итоговое сравнение

- **AE:**
    
    - Детерминированное сжатие входных данных, простая архитектура и быстрая обработка, но не обладает генеративными свойствами.
        
- **VAE:**
    
    - Вводит вероятностное латентное пространство, что позволяет генерировать новые данные и обеспечивает более гладкое распределение, однако сложнее в обучении из-за репараметризации и балансировки потерь.
        
- **Multi-VAE:**
    
    - Специализированный вариант VAE для рекомендаций, оптимизирован для работы с разреженными и дискретными данными через использование мультиномиальной реконструкции, что делает его особенно эффективным в задачах коллаборативной фильтрации.
        

Каждый из алгоритмов имеет свои преимущества и применяется в зависимости от специфики задачи, доступных данных и требований к генеративным возможностям модели.