–ò–¥–µ—è –≤ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è 
$$\Large f^{\text{—Ñ-—è –æ—Ü–µ–Ω–∫–∏}}_{ui}: \text{User} \times \text{Item} \rightarrow \text{Relevance}$$
–î–∞–ª–µ–µ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –ª–æ—Å—Å—ã $R$ –º–∞—Ç—Ä–∏—Ü—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π (–∏—Å—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π) –∏ $\hat R$ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö
$$\Large L(R, \hat R) \rightarrow \min$$

$$
\large
\begin{bmatrix}
\color{green}{1} & 
\color{blue}{2} & 
\color{blue}{...} & 
\color{blue}{n} & 
\\
\color{orange}{2} & 
&
\color{blue}\downarrow
& 
\color{blue}\downarrow
\\
\color{orange}{...} &
\color{orange}{\rightarrow}
\\
\color{orange}{m} & 
\color{orange}{\rightarrow} & 
\end{bmatrix}^{\color{white}R\in\mathbb{R}^{(m,n)}}

\approx

\color{blue}{\begin{bmatrix}
\color{blue}{\uparrow} & 1
\\
\color{blue}{|} & 2
\\
\color{blue}{|} & ..
\\
\color{blue}{\downarrow} & k
\end{bmatrix}}^{\color{white}P\in\mathbb{R}^{(k, 1)}}
\color{white}

\times

\color{orange}{\begin{bmatrix}
{\leftarrow} & - & - & \rightarrow 
\\
1 & 2 & ... & k
\end{bmatrix}^{\color{white}Q^T\in\mathbb{R}^{(1, k)}}}
$$

  - R: –ú–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
  - P: –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—ç–º–±–µ–¥–∏–Ω–≥–æ–≤)
  - Q: –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ (—ç–º–±–µ–¥–∏–Ω–≥–æ–≤)
  - k: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

–§—É–Ω–∫—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ (–ø—Ä–æ—Å—Ç–æ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ): $$\Large\hat r_{ui} = p_uq^T_i = \sum p_{ud}q_{di}$$
–§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ (MSE + reg): $$\Large L = \sum_{u,i\in S}(r_{ui} - p_uq^T_i)^2 + \lambda(\sum||p_u||^2 + \sum||q_i||^2)$$

---
## SVD —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ

- –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã–µ (–ø–æ—ç—Ç–æ–º—É –∑–∞–ø–æ–ª–Ω—è–µ–º 0)
	- –ü–æ—ç—Ç–æ–º—É –Ω–µ —Ç–∞–∫ —Ö–æ—Ä–æ—à –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- –•–æ—Ä–æ—à –¥–ª—è —Ç–æ–ø-N –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
	- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—á–∏—Ç–∞–µ–º —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–æ –≤—Å–µ–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
	- –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ø –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º

$$\LARGE A = U\Sigma V^T$$
$$
\begin{bmatrix}
\color{green}{} & 
\color{blue}{} & 
\color{blue}{} & 
\color{blue}{} & 
\\
\color{orange}{} & 
&
\color{blue}
& 
\color{blue}
\\
\color{orange}{} &
\color{orange}{}
\\
\color{orange}{} & 
\color{orange}{} & 
\end{bmatrix}^{\color{white}A \in\mathbb{R}^{(m, n)}}

=

\color{blue}{\begin{bmatrix}
\color{blue}{} & 
\\
\color{blue}{} & 
\\
\color{blue}{} &
\\
\color{blue}{} & 
\end{bmatrix}}^{\color{white}U\in\mathbb{R}^{(m, m)}}_{\color{white}\text{–æ—Ä—Ç. –º–∞—Ç—Ä–∏—Ü–∞}}
\color{white}

\times

\color{green}{\begin{bmatrix}
\color{blue}{} & &
\\
\color{blue}{} & 

\end{bmatrix}}^{\color{white}\Sigma\in\mathbb{R}^{(m, n)}}_{\color{white}\begin{matrix}\text{–¥–∏–∞–≥. –º–∞—Ç—Ä–∏—Ü–∞}\\ k = \min(m,n)\end{matrix}}
\color{white}

\times

\color{orange}{\begin{bmatrix}
 &  &  & & & 

\end{bmatrix}^{\color{white}V^T\in\mathbb{R}^{(n, n)}}_{\color{white}\text{–æ—Ä—Ç. –º–∞—Ç—Ä–∏—Ü–∞}}}
$$
1. **–õ–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (–º–∞—Ç—Ä–∏—Ü–∞ $( U )$)**:
   - –ú–∞—Ç—Ä–∏—Ü–∞ $( U )$ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –æ—Ä—Ç–æ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã.
   - –ï—Å–ª–∏ $( A )$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $( m \times n )$, —Ç–æ $( U )$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $( m \times m )$.
   - –õ–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã —è–≤–ª—è—é—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –º–∞—Ç—Ä–∏—Ü—ã $( A A^T )$.

2. **–ü—Ä–∞–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (–º–∞—Ç—Ä–∏—Ü–∞ $( V )$)**:
   - –ú–∞—Ç—Ä–∏—Ü–∞ $( V )$ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ —è–≤–ª—è—é—Ç—Å—è –æ—Ä—Ç–æ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏.
   - –ú–∞—Ç—Ä–∏—Ü–∞ $( V )$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $( n \times n )$.
   - –ü—Ä–∞–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã —è–≤–ª—è—é—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –º–∞—Ç—Ä–∏—Ü—ã $( A^T A )$.

–Ω–æ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ `(–ø–æ—á–µ–º—É?: –º–± –ø–æ—Ç–æ–º—É —á—Ç–æ –º–Ω–æ–≥–æ —Å—á–∏—Ç–∞—Ç—å)` –ø–æ—ç—Ç–æ–º—É –±–µ—Ä–µ–º —É—Ä–µ–∑–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é - __–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤—ã–±–∏—Ä–∞—é—Ç –ø–µ—Ä–≤—ã–µ ùëò –Ω–∞–∏–±–æ–ª—å—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–º—É —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—é__: $$\Large A \approx U_k\Sigma_kV^T_k = \hat R$$
$$
\begin{bmatrix}
\color{green}{} & 
\color{blue}{} & 
\color{blue}{} & 
\color{blue}{} & 
\\
\color{orange}{} & 
&
\color{blue}
& 
\color{blue}
\\
\color{orange}{} &
\color{orange}{}
\\
\color{orange}{} & 
\color{orange}{} & 
\end{bmatrix}^{\color{white}A \in\mathbb{R}^{(m, n)}}

\approx

\color{blue}{\begin{bmatrix}
\color{blue}{} & 
\\
\color{blue}{} & 
\\
\color{blue}{} &
\\
\color{blue}{} & 
\end{bmatrix}}^{\color{white}U_k\in\mathbb{R}^{(m, k)}}_{\color{white}\text{–æ—Ä—Ç. –º–∞—Ç—Ä–∏—Ü–∞}}
\color{white}

\times

\color{green}{\begin{bmatrix}
\color{blue}{} & &
\\
\color{blue}{} & 

\end{bmatrix}}^{\color{white}\Sigma_k\in\mathbb{R}^{(k, k)}}_{\color{white}\begin{matrix}\text{–¥–∏–∞–≥. –º–∞—Ç—Ä–∏—Ü–∞}\\ k = \min(m,n)\end{matrix}}
\color{white}

\times

\color{orange}{\begin{bmatrix}
 &  &  & & & 

\end{bmatrix}^{\color{white}V^T_k\in\mathbb{R}^{(n, k)}}_{\color{white}\text{–æ—Ä—Ç. –º–∞—Ç—Ä–∏—Ü–∞}}}
$$

- $\large U_k \in \mathbb{R}^{(m\times k)}$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º $( m \times k )$, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –ø–µ—Ä–≤—ã–µ $( k )$ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑$( U )$,
- $\large V_k \in \mathbb{R}^{(n\times k)}$ ‚Äî –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º $( k \times k )$, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –ø–µ—Ä–≤—ã–µ $( k )$ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏,
- $\large \Sigma_k \in \mathbb{R}^{(k\times k)}$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º $( n \times k )$, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –ø–µ—Ä–≤—ã–µ $( k )$ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ $( V )$.

–í $\Sigma$ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã. –û–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–µ–ø–µ–Ω—å –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤.

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: $\Large ||A_{\text{–∏—Å—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞}} - \hat R_{\text{–ü–æ–ª—É—á–µ–Ω–Ω–∞—è —É—Ä–µ–∑–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞}}||^2_F\rightarrow \min$

–•—Ä–∞–Ω–∏—Ç—å –º—ã –º–æ–∂–µ–º —Ç–æ–ª—å–∫–æ $A$ –∏ $V$ –ø–æ—Ç–æ–º—É —á—Ç–æ: $$\large\begin{matrix} AV_kV^T_k = U\Sigma V^TV_kV^T_k \\ AV_kV^T_k = U_k\Sigma_k V^T_k = \hat R\end{matrix}$$

